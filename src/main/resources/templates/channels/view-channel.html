<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Channel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/icon.css" rel="stylesheet">
    <link href="/css/chat.css" rel="stylesheet">
</head>
<body>

<div th:replace="~{/home_pages/home ::navigation}"></div>

<main class="d-flex justify-content-between align-items-start vh-90 mt-5">

    <div class="d-flex gap-1 flex-grow-1 h-100">
        <!-- Channel List -->
        <div class="channel-list border border-outline">
            <h5 th:text="${channel.getProject().getTitle()}"></h5>
            <hr>
            <h6>Channels</h6>
            <div th:each="channel : ${channel.getProject().getChannels()}" class="channel-item">
                <a th:href="@{/project/{projectName}/channels/{channelName} (projectName=${channel.getProject().getTitle()}, channelName=${channel.getName()})}"
                   th:text="${channel.getName()}"
                   class="nav-link"
                >Channel Name</a>
            </div>
        </div>

        <div class="container chat-container">
            <!-- Header -->
            <div class="chat-header">
                <h3 class="mb-0" th:text="${channel.getName()}">Channel Name</h3>
            </div>

            <!-- Main Content (Messages Section) -->
            <div class="chat-messages">
                <!-- Example Messages -->
                <div class="message-bubble incoming" th:each="message : ${messages}">
                    <div id="user-info">
                        <img th:src="${message.getAvatarUrl()}" class="rounded-circle icon-small" alt="user-logo"
                        style="width: 3rem;height: 3rem;">
                    </div>
                    <div id="message-info" class="message-info">
                        <small class="text-secondary fst-italic">
                            <span th:text="${message.getSenderUsername()}">Username</span>
                            <span th:text="${#temporals.format(message.getSentAt(), 'dd/MM/yyyy &bull; HH:mm')}">&nbsp;datum â€¢ vreme</span>
                        </small>
                        <p th:text="${message.getContent()}" class="lead text-break">Message Content</p>
                    </div>

                </div>
<!--                Tuka pocvat messages-->

            </div>

            <!-- Input Section -->
            <div class="input-container">
                <textarea class="form-control h-fit-content" name="chatMessage" placeholder="Type your message..."></textarea>
                <button class="btn btn-primary">Send</button>
            </div>
        </div>

    </div>

    <!-- User List -->
    <div class="user-list me-3 border border-outline shadow">
        <h5 style="text-align: center">Users</h5>
        <hr>
        <div th:each="developer : ${channel.getProject().getDevelopers()}" class="user-item">
            <img th:src="${developer.getAvatarUrl()}" class="rounded-circle icon-small" alt="user-logo"
                 style="width: 3rem;height: 3rem;">
            <span class="text-break" th:text="${developer.getUsername()}"></span>
        </div>
    </div>

</main>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.querySelector('.btn-primary').addEventListener('click', () => {
        const input = document.querySelector('.form-control');
        const messageText = input.value.trim();
        if (messageText) {
            const messagesContainer = document.querySelector('.chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message-bubble outgoing';
            messageDiv.textContent = messageText;
            messagesContainer.appendChild(messageDiv);
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
    });
</script>
</body>
</html>
